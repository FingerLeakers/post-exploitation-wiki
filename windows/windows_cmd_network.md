<!-- Code for collapse and expand -->
<script type="text/javascript"> 
$(document).ready(function() { 
$('div.view').hide(); 
$('div.slide').click(function() {
$(this).next('div.view').slideToggle('fast'); 
return false; 
}); 
}); 
</script>

# Windows CMD Network Commands

The Windows commands below will help you gather information about the victim system's network connections, devices and capabilities and are usually executed from the context of the `cmd.exe` or `command.exe` prompt.

## ipconfig
### Retrieve Local DNS Cache Info
 * **Command with arguments**: `ipconfig /displaydns`
 * **Description**: Displays the system's local DNS cache.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>ipconfig/displaydns<br>Windows IP Configuration<br>
    1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa
    ----------------------------------------<br>    Record Name . . . . . : 1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa.
    Record Type . . . . . : 12
    Time To Live  . . . . : 86400
    Data Length . . . . . : 4
    Section . . . . . . . : Answer
    PTR Record  . . . . . : localhost<br><br>
    1.0.0.127.in-addr.arpa
    ----------------------------------------<br>    Record Name . . . . . : 1.0.0.127.in-addr.arpa.
    Record Type . . . . . : 12
    Time To Live  . . . . : 86400
    Data Length . . . . . : 4
    Section . . . . . . . : Answer
    PTR Record  . . . . . : localhost<br><br>
    _ldap._tcp.default-first-site-name._sites.win-0p19ull2nb6.lab.sky.net
    ----------------------------------------<br>    Name does not exist.<br><br>
    _ldap._tcp.win-0p19ull2nb6.lab.sky.net
    ----------------------------------------<br>    Name does not exist.<br><br>
    localhost
    ----------------------------------------<br>    Record Name . . . . . : localhost
    Record Type . . . . . : 1
    Time To Live  . . . . : 86400
    Data Length . . . . . : 4
    Section . . . . . . . : Answer
    A (Host) Record . . . : 127.0.0.1<br><br>
    localhost
    ----------------------------------------<br>    Record Name . . . . . : localhost
    Record Type . . . . . : 28
    Time To Live  . . . . : 86400
    Data Length . . . . . : 16
    Section . . . . . . . : Answer
    AAAA Record . . . . . : ::1</code></div>
    
### Retrieve NIC Info
 * **Command with arguments**: `ipconfig /all`
 * **Description**: Displays the full information about the system's network interface cards (NICs).
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>ipconfig/all<br>
Windows IP Configuration<br>
   Host Name . . . . . . . . . . . . : WIN-0P19ULL2NB6
   Primary Dns Suffix  . . . . . . . : lab.sky.net
   Node Type . . . . . . . . . . . . : Hybrid
   IP Routing Enabled. . . . . . . . : No
   WINS Proxy Enabled. . . . . . . . : No
   DNS Suffix Search List. . . . . . : lab.sky.net
                                       sky.net<br>
Ethernet adapter Local Area Connection:<br>
   Connection-specific DNS Suffix  . :
   Description . . . . . . . . . . . : Intel(R) PRO/1000 MT Network Connection
   Physical Address. . . . . . . . . : 00-0C-29-9A-E2-26
   DHCP Enabled. . . . . . . . . . . : No
   Autoconfiguration Enabled . . . . : Yes
   Link-local IPv6 Address . . . . . : fe80::11bc:e019:25e5:916d%10(Preferred)
   IPv4 Address. . . . . . . . . . . : 192.168.10.34(Preferred)
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Default Gateway . . . . . . . . . : 192.168.10.1
   DHCPv6 IAID . . . . . . . . . . . : 234884137
   DHCPv6 Client DUID. . . . . . . . : 00-01-00-01-19-E6-78-04-00-0C-29-9A-E2-26
   DNS Servers . . . . . . . . . . . : ::1
                                       127.0.0.1
   NetBIOS over Tcpip. . . . . . . . : Enabled<br>
Tunnel adapter Local Area Connection* 8:<br>
   Media State . . . . . . . . . . . : Media disconnected
   Connection-specific DNS Suffix  . :
   Description . . . . . . . . . . . : isatap.{DDE3DF3D-3417-4EBF-BF66-73BD3A64FF26}
   Physical Address. . . . . . . . . : 00-00-00-00-00-00-00-E0
   DHCP Enabled. . . . . . . . . . . : No
   Autoconfiguration Enabled . . . . : Yes</code></div>
----

## Misc
### arp
 * **Command with arguments**: `arp -a`
 * **Description**: Lists all the systems currently in the machine's ARP table.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>arp -a<br>
Interface: 192.168.10.34 --- 0xa
  Internet Address      Physical Address      Type
  192.168.10.255        ff-ff-ff-ff-ff-ff     static
  224.0.0.22            01-00-5e-00-00-16     static
  224.0.0.252           01-00-5e-00-00-fc     static</code></div> 

### wmic
 * **Command with arguments**: `wmic ntdomain list`
 * **Description**: Retrieve information about Domain and Domain Controller.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>wmic ntdomain list
DomainGuid
{CD5C2FE3-5AFE-459D-804E-A81B49066CAD}</code></div>    
----

## net
For more information: http://technet.microsoft.com/en-us/library/bb490949.aspx
(Coming soon!)

----

## netstat
For more information: http://technet.microsoft.com/en-us/library/bb490947.aspx

### Find Information about a specific Service
 * **Command with arguments**: `netstat -nabo | findstr /I [SERVICE|PROCESS|PORT]`
 * **Description**: **Needs to be launched within an administrative command shell due to the `-b`.** If you are interested in finding out more information about a specific service, process or port this will provide greater depth of information. The `netstat -b` flag makes the command take longer but will output the process name using each of the connections.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Windows\system32>netstat -nabo |findstr /I 445<br>
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
  TCP    [::]:445               [::]:0                 LISTENING       4
  UDP    0.0.0.0:62445          *:*                                    1756
  UDP    0.0.0.0:63445          *:*                                    1756
  UDP    [::]:49445             *:*                                    1756
  UDP    [::]:64445             *:*                                    1756
  UDP    [::]:64450             *:*                                    1756
  UDP    [::]:64451             *:*                                    1756</code></div>
  
### Find Listeners
 * **Command with arguments**: `netstat -na | findstr :[PORT]`
 * **Description**: Find all listening ports and connections on port [PORT] (replace port with your target such as `80` or `3389`).
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>netstat -na | findstr :445
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING
  TCP    [::]:445               [::]:0                 LISTENING</code></div>

### Find Listeners and Process IDs
 * **Command with arguments**: `netstat -nao | findstr /I listening`
 * **Description**: Find all listening ports and their associated PIDs (Process IDs). The `findstr /I` switch makes the search case insensitive. This could be important if you are looking for a buMPy service (example: `svchost` vs. `SVChost`) or don't know the case of it.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>netstat -nao | findstr /I listening
  TCP    0.0.0.0:88             0.0.0.0:0              LISTENING       592
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       908
  TCP    0.0.0.0:389            0.0.0.0:0              LISTENING       592
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:464            0.0.0.0:0              LISTENING       592
  TCP    0.0.0.0:593            0.0.0.0:0              LISTENING       908
  TCP    0.0.0.0:636            0.0.0.0:0              LISTENING       592
  TCP    0.0.0.0:3268           0.0.0.0:0              LISTENING       592
  TCP    0.0.0.0:3269           0.0.0.0:0              LISTENING       592
  TCP    0.0.0.0:3389           0.0.0.0:0              LISTENING       1208
  TCP    0.0.0.0:49152          0.0.0.0:0              LISTENING       500
  TCP    0.0.0.0:49153          0.0.0.0:0              LISTENING       984
  TCP    0.0.0.0:49154          0.0.0.0:0              LISTENING       1056
  TCP    0.0.0.0:49156          0.0.0.0:0              LISTENING       592
  TCP    0.0.0.0:49157          0.0.0.0:0              LISTENING       592
  TCP    0.0.0.0:49158          0.0.0.0:0              LISTENING       592
  TCP    0.0.0.0:49161          0.0.0.0:0              LISTENING       1804
  TCP    0.0.0.0:49169          0.0.0.0:0              LISTENING       1756
  TCP    0.0.0.0:49170          0.0.0.0:0              LISTENING       580
  TCP    127.0.0.1:53           0.0.0.0:0              LISTENING       1756
  TCP    192.168.10.34:53       0.0.0.0:0              LISTENING       1756
  TCP    192.168.10.34:139      0.0.0.0:0              LISTENING       4
  TCP    [::]:88                [::]:0                 LISTENING       592
  TCP    [::]:135               [::]:0                 LISTENING       908
  TCP    [::]:389               [::]:0                 LISTENING       592
  TCP    [::]:445               [::]:0                 LISTENING       4
  TCP    [::]:464               [::]:0                 LISTENING       592
  TCP    [::]:593               [::]:0                 LISTENING       908
  TCP    [::]:636               [::]:0                 LISTENING       592</code></div>

### List Ports and Connections
 * **Command with arguments**: `netstat -nabo`
 * **Description**: **Needs to be launched within an administrative command shell.** Lists ports on and connections with the system with corresponding process (`-b`), without performing DNS lookup (`-n`), all connections (`-a`) and what is the owning process ID (`-o`). The `-b` switch is the switch in this command that requires elevated or admin privileges to execute. Omit it and you do not need to have an admin cmd shell.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Windows\system32>netstat -nabo<br>
Active Connections<br>
  Proto  Local Address          Foreign Address        State           PID
  TCP    0.0.0.0:88             0.0.0.0:0              LISTENING       592
 [lsass.exe]
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       908
  RpcSs
 [svchost.exe]
  TCP    0.0.0.0:389            0.0.0.0:0              LISTENING       592
 [lsass.exe]
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4<br>
 Can not obtain ownership information<br>
x: Windows Sockets initialization failed: 5
  TCP    0.0.0.0:464            0.0.0.0:0              LISTENING       592
 [lsass.exe]
  TCP    0.0.0.0:593            0.0.0.0:0              LISTENING       908
  RpcSs
 [svchost.exe]
  TCP    0.0.0.0:636            0.0.0.0:0              LISTENING       592
 [lsass.exe]
  TCP    0.0.0.0:3268           0.0.0.0:0              LISTENING       592
 [lsass.exe]
  TCP    0.0.0.0:3269           0.0.0.0:0              LISTENING       592
 [lsass.exe]
  TCP    0.0.0.0:3389           0.0.0.0:0              LISTENING       1208
  Dnscache</code></div> 

### Routing Table
 * **Command with arguments**: `netstat -r`
 * **Description**: Displays the system's routing table.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>netstat -r<br>===========================================================================<br>Interface List<br> 10 ...00 0c 29 9a e2 26 ...... Intel(R) PRO/1000 MT Network Connection<br>  1 ........................... Software Loopback Interface 1<br> 12 ...00 00 00 00 00 00 00 e0  isatap.{DDE3DF3D-3417-4EBF-BF66-73BD3A64FF26}<br> 11 ...02 00 54 55 4e 01 ...... Teredo Tunneling Pseudo-Interface<br>===========================================================================<br><br>IPv4 Route Table<br>===========================================================================<br>Active Routes:<br>Network Destination        Netmask          Gateway       Interface  Metric<br>          0.0.0.0          0.0.0.0     192.168.10.1    192.168.10.34    266<br>        127.0.0.0        255.0.0.0         On-link         127.0.0.1    306<br>        127.0.0.1  255.255.255.255         On-link         127.0.0.1    306<br>  127.255.255.255  255.255.255.255         On-link         127.0.0.1    306<br>     192.168.10.0    255.255.255.0         On-link     192.168.10.34    266<br>    192.168.10.34  255.255.255.255         On-link     192.168.10.34    266<br>   192.168.10.255  255.255.255.255         On-link     192.168.10.34    266<br>        224.0.0.0        240.0.0.0         On-link         127.0.0.1    306<br>        224.0.0.0        240.0.0.0         On-link     192.168.10.34    266<br>  255.255.255.255  255.255.255.255         On-link         127.0.0.1    306<br>  255.255.255.255  255.255.255.255         On-link     192.168.10.34    266<br>===========================================================================<br>Persistent Routes:<br>  Network Address          Netmask  Gateway Address  Metric<br>          0.0.0.0          0.0.0.0     192.168.10.1  Default<br>===========================================================================<br><br>IPv6 Route Table<br>===========================================================================<br>Active Routes:<br> If Metric Network Destination      Gateway<br>  1    306 ::1/128                  On-link<br> 10    266 fe80::/64                On-link<br> 10    266 fe80::11bc:e019:25e5:916d/128<br>                                    On-link<br>  1    306 ff00::/8                 On-link<br> 10    266 ff00::/8                 On-link<br>===========================================================================<br>Persistent Routes:<br>  None</code></div>  