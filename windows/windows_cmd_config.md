<script type="text/javascript">
  $(document).ready(function() {
  // Hide the "view" div.
  $('div.view').hide();
  // Watch for clicks on the "slide" link.
  $('div.slide').click(function() {
  // When clicked, toggle the "view" div.
  $('div.view').slideToggle(400);
  return false;
});
});
</script>

# Windows CMD Config Commands

Commands that display information about the configuration of the victim and are usually executed from the context of the CMD.exe prompt.

## Misc

| Command | Expected Output | Sample Output |
| ------- | --------------- | ------------- |
| `whoami` <br /> `whoami/all` | Lists information about the user you are currently logged in as. Helpful for showing what groups, sid and privileges of this user. Not available in all versions of Windows but is in Windows Vista and more recent. According to [Wikipedia](http://en.wikipedia.org/wiki/Whoami), this command can be added to Windows 2000 using the resource kit and is installed in Windows XP SP2 Support Tools. | *Win2008* <div class="slide" style="cursor: pointer;">Show/Hide</div><div class="view"><code>C:\Users\johndoe>whoami<br>lab\johndoe<br><br>C:\Users\johndoe>whoami/all<br><br>USER INFORMATION<br>----------------<br><br>User Name   SID<br>=========== ===========================================<br>lab\johndoe S-1-5-21-60789211-843652525-1994898995-1001<br><br><br>GROUP INFORMATION<br>-----------------<br><br>Group Name                                 Type             SID          Attributes<br>========================================== ================ ============ ==================================================<br>Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group<br>BUILTIN\Users                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group<br>BUILTIN\Administrators                     Alias            S-1-5-32-544 Group used for deny only<br>BUILTIN\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554 Group used for deny only<br>NT AUTHORITY\INTERACTIVE                   Well-known group S-1-5-4      Mandatory group, Enabled by default, Enabled group<br>NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group<br>NT AUTHORITY\This Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group<br>LOCAL                                      Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group<br>Mandatory Label\Medium Mandatory Level     Unknown SID type S-1-16-8192  Mandatory group, Enabled by default, Enabled group<br><br><br>PRIVILEGES INFORMATION<br>----------------------<br><br>Privilege Name                Description                          State<br>============================= ==================================== ========<br>SeShutdownPrivilege           Shut down the system                 Disabled<br>SeChangeNotifyPrivilege       Bypass traverse checking             Enabled<br>SeUndockPrivilege             Remove computer from docking station Disabled<br>SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled<br>SeTimeZonePrivilege           Change the time zone                 Disabled</code></div> |
| `set` | Shows all current environmental variables. Specific ones to look for are USERDOMAIN, USERNAME, USERPROFILE, HOMEPATH, LOGONSERVER, COMPUTERNAME, APPDATA, and ALLUSERPROFILE. |
| `fsutil fsinfo drives` | **Must be ADMIN to run this.** Lists the current drives on the system. |
| `reg query HKLM /s /d /f "C:\* *.exe"` &#124; `find /I "C:\"` &#124; `find /V """"` | Securely registered executables within the system registry. |
| `c:\windows\system32\gathernetworkinfo.vbs` | **Win7 Only** Script included gathers data about the system and stores output in files in the c:\windows\system32\config directory. External link [here.](http://www.verboon.info/index.php/2011/06/the-gathernetworkinfo-vbs-script/) |
| `echo %COMSPEC%%` | Determine the location of the command line interpreter such as cmd.exe. |
| `gpresult /z` | Extremely verbose output of GPO (Group policy) settings as applied to the current system and user. |
| `set` | Dumps the environment variables for the current user. Very helpful command. |
| `type %WINDIR%\System32\drivers\etc\hosts` | Show the contents of the system's host file which does the local translation of IP address to hostname. This file may contain important servers. |

## Registry
For more information: http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/reg.mspx?mfr=true or http://www.petri.co.il/reg_command_in_windows_xp.htm

| Command | Expected Output | 
| ------- | --------------- |
| `reg save [HIVE] [OUTFILE]` | **Must be run as an administrator.** Saves part of the registry to a file. Replace [HIVE] with HKLM\Security, HKLM\System, or HKLM\SAM and [OUTFILE] with the name of the file you would like to save the registry in. |
| `reg add [\\TargetIPaddr\] [RegDomain\Key]` | Adds a key to target machine's registry. Replace [\\TargetIPaddr] with your target system, [RegDomain\Key] with the registry domain and key you'd like to insert. |
| `reg export [RegDomain\Key] [OUTFILE]` | Exports a key to a file. Replace [RegDomain\Key] with the registry domain and key you'd like to insert and [OUTFILE] with the name of the file you would like to save the registry key in. |
| `reg import [INFILE]`	| Imports content to target machine's registry. Replace [INFILE] with the file that has the content you wish to insert.	|
| `reg query [\\TargetIPaddr\] [RegDomain\Key] /v [ValueName]` | Retrieves a key and value from target machine's registry. Replace [\\TargetIPaddr] with your target system, [RegDomain\Key] with the registry domain and key you'd like to query. |

## sc
For more information: http://technet.microsoft.com/en-us/library/bb490995.aspx

| Command | Expected Output | 
| ------- | --------------- |
| `sc qc [servicename]` | sc.exe retrieves and sets control information about services. You can use sc.exe for testing and debugging service programs. Things to look at here are the path to the executable, the start type (does it start at boot or on demand?), and service names. |
| `sc query [servicename]` | This shows the status of the [servicename] queried. |
| `sc queryex [servicename]` | Shows the extended status (such as the Process ID) of the [servicename]. |

## wmi

For more information: http://msdn.microsoft.com/en-us/library/aa394531(v=vs.85).aspx and https://isc.sans.edu/diary/Windows+Command-Line+Kung+Fu+with+WMIC/1229. For most of these commands you can add list full to the end and retrieve the data in a non-table format. Sometimes this view is easier to read.

| Command | Expected Output | 
| ------- | --------------- |
| `wmic bios` | Retrieves BIOS information including system serial number. |
| `wmic qfe get hotfixid` | Retrieves patch IDs |
| `wmic startup list full` | Shows startup items, which user runs them and full paths to the executables. |
| `wmic service list full` | Retrieves ton of information about all the services installed on the system. |
| `wmic process get caption,executablepath,commandline` | Retrieves process names, captions, executable paths and command line flags. |
| `wmic process call create [EXECUTABLE]` | Launches an executable. Replace [EXECUTABLE] with the name of the executable you'd like to launch (for example: calc.exe). Do not include quotes around the value (for example: DO use calc.exe; do NOT use "calc.exe") |
| `wmic process where name="[PROCESS]" call terminate` | Terminates a process. Replace [PROCESS] with the name of the process you'd like to terminate and you DO need the quotes around it (for example: calc.exe) |
| `wmic logicaldisk where drivetype=3 get name, freespace, systemname, filesystem, size, volumeserialnumber` | Retrieve information about the harddrive. |
| `wmic useraccount list full` | Retrieve information about the user accounts on the system. |
| `wmic share` | Retrieve information about local shares. | 