# Windows CMD Config Commands

Commands that display information about the configuration of the victim and are usually executed from the context of the CMD.exe prompt.

## Misc Commands

| Command | Expected Output | 
| ------- | --------------- |
| `whoami` <br /> `whoami/all` | Lists information about the user you are currently logged in as. Helpful for showing what groups, sid and privileges of this user. Not available in all versions of Windows but is in Windows Vista and more recent. According to [Wikipedia](http://en.wikipedia.org/wiki/Whoami), this command can be added to Windows 2000 using the resource kit and is installed in Windows XP SP2 Support Tools. |
| `set` | Shows all current environmental variables. Specific ones to look for are USERDOMAIN, USERNAME, USERPROFILE, HOMEPATH, LOGONSERVER, COMPUTERNAME, APPDATA, and ALLUSERPROFILE. |
| `fsutil fsinfo drives` | **Must be ADMIN to run this.** Lists the current drives on the system. |
| `reg query HKLM /s /d /f "C:\* *.exe"` &#124; `find /I "C:\"` &#124; `find /V """"` | Securely registered executables within the system registry. |
| `c:\windows\system32\gathernetworkinfo.vbs` | **Win7 Only** Script included gathers data about the system and stores output in files in the c:\windows\system32\config directory. External link [here.](http://www.verboon.info/index.php/2011/06/the-gathernetworkinfo-vbs-script/) |
| `echo %COMSPEC%%` | Determine the location of the command line interpreter such as `cmd.exe.` |
| `gpresult /z` | Extremely verbose output of GPO (Group policy) settings as applied to the current system and user. |
| `set` | Dumps the environment variables for the current user. Very helpful command. |
| `type %WINDIR%\System32\drivers\etc\hosts` | Show the contents of the system's host file which does the local translation of IP address to hostname. This file may contain important servers. |

## Registry Commands
For more information: http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/reg.mspx?mfr=true or http://www.petri.co.il/reg_command_in_windows_xp.htm

| Command | Expected Output | 
| ------- | --------------- |
| `reg save [HIVE] [OUTFILE]` | **Must be run as an administrator.** Saves part of the registry to a file. Replace [HIVE] with HKLM\Security, HKLM\System, or HKLM\SAM and [OUTFILE] with the name of the file you would like to save the registry in. |
| `reg add [\\TargetIPaddr\] [RegDomain\Key]` | Adds a key to target machine's registry. Replace [\\TargetIPaddr] with your target system, [RegDomain\Key] with the registry domain and key you'd like to insert. |
| `reg export [RegDomain\Key] [OUTFILE]` | Exports a key to a file. Replace [RegDomain\Key] with the registry domain and key you'd like to insert and [OUTFILE] with the name of the file you would like to save the registry key in. |
| `reg import [INFILE]`	| Imports content to target machine's registry. Replace [INFILE] with the file that has the content you wish to insert.	|
| `reg query [\\TargetIPaddr\] [RegDomain\Key] /v [ValueName]` | Retrieves a key and value from target machine's registry. Replace [\\TargetIPaddr] with your target system, [RegDomain\Key] with the registry domain and key you'd like to query. |